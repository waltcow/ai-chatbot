# Railway Deployment Guide

This guide will help you deploy your AI Chatbot to Railway.

## Prerequisites

1. **Railway Account**: Sign up at [railway.app](https://railway.app)
2. **Railway CLI**: Install the Railway CLI
3. **API Keys**: Obtain your xAI API key
4. **Database**: Railway PostgreSQL addon (recommended)

## Quick Start

### 1. Install Railway CLI

```bash
npm install -g @railway/cli
```

### 2. Login to Railway

```bash
railway login
```

### 3. Deploy with Script

Run the deployment script:

```bash
./deploy-railway.sh
```

## Manual Deployment Steps

### 1. Initialize Railway Project

```bash
railway init
```

### 2. Add PostgreSQL Database

In your Railway dashboard:
- Click "Add Service" → "Database" → "PostgreSQL"
- This will automatically generate a `POSTGRES_URL` environment variable

### 3. Set Environment Variables

In your Railway project dashboard, add these environment variables:

```bash
# Required
AUTH_SECRET=your-generated-secret-here
XAI_API_KEY=your-xai-api-key
POSTGRES_URL=${{Postgres.DATABASE_URL}}  # Auto-generated by Railway
NEXT_PUBLIC_APP_URL=${{RAILWAY_PUBLIC_DOMAIN}}  # Auto-generated by Railway

# Optional
REDIS_URL=redis://default:password@host:port  # If using Redis addon
NODE_ENV=production
PORT=3000
```

### 4. Deploy

```bash
railway up
```

## Environment Variables Setup

### AUTH_SECRET
Generate a secure secret:
```bash
openssl rand -base64 32
```

### XAI_API_KEY
1. Visit [console.x.ai](https://console.x.ai/)
2. Create an account or log in
3. Generate an API key
4. Copy the key to your Railway environment variables

### Database Configuration
Railway will automatically:
- Create a PostgreSQL database
- Generate connection credentials
- Set the `POSTGRES_URL` environment variable

## Post-Deployment

### 1. Database Migration
The app will automatically run database migrations on build due to this script in `package.json`:
```json
"build": "tsx lib/db/migrate && next build"
```

### 2. Custom Domain (Optional)
In Railway dashboard:
- Go to your service settings
- Add a custom domain if needed

### 3. Monitoring
Monitor your deployment in the Railway dashboard:
- View logs
- Check metrics
- Monitor database usage

## Troubleshooting

### Build Issues
- Check Railway build logs
- Ensure all dependencies are in `package.json`
- Verify Dockerfile syntax

### Database Connection Issues
- Verify `POSTGRES_URL` is set correctly
- Check database addon is running
- Review connection string format

### Environment Variables
- Ensure all required variables are set
- Check for typos in variable names
- Verify API keys are valid

## Railway Features Used

- **Dockerfile Support**: Uses your existing Dockerfile
- **Automatic HTTPS**: Railway provides SSL certificates
- **Environment Variables**: Secure variable management
- **PostgreSQL Addon**: Managed database service
- **Auto-scaling**: Handles traffic automatically
- **GitHub Integration**: Deploy on every push (optional)

## Cost Considerations

Railway pricing is based on:
- Resource usage (CPU, Memory, Network)
- Database storage and queries
- Free tier available for small projects

Check [Railway pricing](https://railway.app/pricing) for current rates.

## Support

- [Railway Documentation](https://docs.railway.app/)
- [Railway Discord](https://discord.gg/railway)
- [GitHub Issues](https://github.com/railwayapp/railway/issues)
