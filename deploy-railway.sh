#!/bin/bash

# Railway Deployment Script for AI Chatbot
# This script helps you deploy your AI chatbot to Railway

echo "ğŸš‚ Railway Deployment Script for AI Chatbot"
echo "============================================="

# Check if Railway CLI is installed
if ! command -v railway &> /dev/null; then
    echo "âŒ Railway CLI is not installed."
    echo "ğŸ“¥ Install it with: npm install -g @railway/cli"
    echo "ğŸ”— Or visit: https://docs.railway.app/guides/cli"
    exit 1
fi

echo "âœ… Railway CLI found"

# Check if user is logged in
if ! railway whoami &> /dev/null; then
    echo "ğŸ” Please log in to Railway first:"
    echo "   railway login"
    exit 1
fi

echo "âœ… Railway authentication verified"

# Initialize project if not already done
if [ ! -f "railway.toml" ]; then
    echo "ğŸ¯ Initializing Railway project..."
    railway init
fi

echo "ğŸ“‹ Deployment Checklist:"
echo "========================"
echo "1. âœ… Dockerfile exists"
echo "2. âœ… package.json configured"
echo "3. âœ… railway.json created"
echo ""
echo "ğŸ”§ Required Environment Variables:"
echo "- AUTH_SECRET (generate with: openssl rand -base64 32)"
echo "- XAI_API_KEY (get from: https://console.x.ai/)"
echo "- POSTGRES_URL (will be auto-generated by Railway PostgreSQL addon)"
echo "- NEXT_PUBLIC_APP_URL (will be auto-generated by Railway)"
echo ""

read -p "ğŸš€ Ready to deploy? (y/N): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    echo "ğŸš‚ Deploying to Railway..."
    railway up
    echo ""
    echo "ğŸ‰ Deployment initiated!"
    echo "ğŸ“± Visit your Railway dashboard to:"
    echo "   - Add PostgreSQL database addon"
    echo "   - Set environment variables"
    echo "   - Monitor deployment progress"
    echo ""
    echo "ğŸ”— Railway Dashboard: https://railway.app/dashboard"
else
    echo "âŒ Deployment cancelled"
fi
